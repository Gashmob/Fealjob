{% extends 'page.html.twig' %}
{% block title %}Créer un CV{% endblock %}
{% block body %}
    <div class="background fixed">
        <div class="relative">
            <svg class="layer no1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="#0099ff" fill-opacity="1"
                      d="M0,160L48,181.3C96,203,192,245,288,229.3C384,213,480,139,576,106.7C672,75,768,85,864,106.7C960,128,1056,160,1152,192C1248,224,1344,256,1392,272L1440,288L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
            <svg class="layer no2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="#0069fa" fill-opacity="1"
                      d="M0,64L48,58.7C96,53,192,43,288,53.3C384,64,480,96,576,106.7C672,117,768,107,864,96C960,85,1056,75,1152,85.3C1248,96,1344,128,1392,144L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
            <svg class="layer no3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="#0029f8" fill-opacity="1"
                      d="M0,320L48,293.3C96,267,192,213,288,197.3C384,181,480,203,576,197.3C672,192,768,160,864,128C960,96,1056,64,1152,53.3C1248,43,1344,53,1392,58.7L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>
    </div>
    <div class="ui text justified container">
        <h3 class="ui center aligned icon header">
            <i class="address card outline icon"></i>
            Nouveau CV
        </h3>
        <form class="ui form segment" method="post">
            <!-- Identité -->
            <h3 class="ui dividing green header">Identité</h3>
            <div class="ui two column grid stackable">
                <div class="ui four wide column middle aligned">
                    <img src="{{ asset('img/placeholders/elyse.png') }}"
                         alt="photo de profil"
                         id="pdp"
                         class="ui small circular centered image">
                </div>
                <div class="ui twelve wide column">
                    <div class="two fields">
                        <div class="field disabled">
                            <label>Prénom</label>
                            <input type="text" name="prenom" value="{{ employe.prenom }}">
                        </div>
                        <div class="field disabled">
                            <label>Nom</label>
                            <input type="text" name="nom" value="{{ employe.nom }}">
                        </div>
                    </div>
                    <div class="two fields">
                        <div class="required field">
                            <label>Né le</label>
                            <input type="date" name="naissance" placeholder="jj/mm/aaaa" required>
                        </div>
                        <div class="field">
                            <label>Photo de profil</label>
                            <div class="ui small basic icon buttons">
                                <label style="width: 150px;" class="ui button" id="pdpLabel" for="photo-profil">
                                    <i class="paperclip icon"></i>
                                    Sélectionner
                                </label>
                                <input type="file" style="display: none;" id="photo-profil"
                                       name="photoProfil" onchange="readURL(this);">
                                <div class="ui button" id="pdpClear"><i class="times icon"></i></div>
                            </div>
                        </div>
                        {#
                        <div class="field">
                            <label>Profil</label>
                            <select class="ui dropdown" name="metier">
                                {% for metier in metiers %}
                                    <option>{{ metier }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        #}
                    </div>
                </div>
            </div>
            <div>
                <div class="two fields">
                    <div class="field">
                        <label>E-mail</label>
                        <div class="ui left icon input">
                            <i class="icon envelope"></i>
                            <input type="text" name="mail" placeholder="Email" value="{{ employe.email }}">
                        </div>
                    </div>
                    <div class="field">
                        <label>Téléphone</label>
                        <div class="ui left icon input">
                            <i class="icon phone"></i>
                            <input type="text" name="telephone" placeholder="Téléphone" value="{{ employe.telephone }}">
                        </div>
                    </div>
                </div>
                <div class="two fields">
                    <div class="field">
                        <label>Adresse</label>
                        <div class="ui left icon input">
                            <i class="icon home"></i>
                            <input type="text" name="adresse" placeholder="16 rue des Coquillages">
                        </div>
                    </div>
                    <div class="field">
                        <label>Situation familiale</label>
                        <select class="ui dropdown" name="situationFamille">
                            {% for situation in situations %}
                                <option value="{{ situation.nom }}">{{ situation.nom }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <!-- Formation -->
            <h3 class="ui dividing green header">Formation</h3>
            <div style="margin-bottom: 10px;" class="formations-list" id="formationsList">
                <div class="ui segment" id="formationsItem">
                    <div class="two fields">
                        <div class="field">
                            <label>Intitulé du diplôme</label>
                            <input type="text" name="diplomes" placeholder="Intitulé du diplôme">
                        </div>
                        <div class="field">
                            <label>Date d'obtention</label>
                            <input type="date" name="dates" placeholder="26/04/2013">
                        </div>
                    </div>
                    <div class="field">
                        <label>Nom de l'établissement</label>
                        <input type="text" name="nomEtablissements" placeholder="Nom de l'établissement">
                    </div>
                </div>
            </div>
            <div class="ui container center aligned">
                <i class="icon plus circle big green" onclick="add_feed()" id="feedPlus"></i>
            </div>
            <!-- Expérience -->
            <h3 class="ui dividing green header">Expérience professionnelle</h3>
            <div style="margin-bottom: 10px;" class="experiences-list" id="experiencesList">
                <div class="ui segment" id="experiencesItem">
                    <div class="two fields">
                        <div class="field">
                            <label>Intitulé du poste</label>
                            <div class="field">
                                <input type="text" name="postes" placeholder="Intitulé du poste">
                            </div>
                        </div>
                        <div class="field">
                            <label>Durée</label>
                            <input type="text" name="durees" placeholder="Durée">
                        </div>
                    </div>
                    <div class="field">
                        <label>Nom de l'entreprise</label>
                        <div class="field">
                            <input type="text" name="nomEntreprises" placeholder="Nom de l'entreprise">
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui container center aligned">
                <i class="icon plus circle big green" onclick="add_exp()" id="expPlus"></i>
            </div>
            <!-- Description -->
            <h3 class="ui dividing green header">Description</h3>
            <div class="field">
                <textarea rows="8" name="description"
                          placeholder="Rajoutez des informations à votre sujet."></textarea>
            </div>
            <!-- Langues -->
            <h3 class="ui dividing green header">Langues</h3>
            <div style="margin-bottom: 10px;" class="langues-list" id="languesList">
                <div class="ui segment hidden" id="languesItem">
                    <div class="two fields">
                        <div class="field">
                            <label>Langue</label>
                            <div class="field">
                                <select class="ui dropdown" name="langue">
                                    <option value="FR">Français</option>
                                    <option value="EN">Anglais</option>
                                    <option value="IT">Italien</option>
                                </select>
                            </div>
                        </div>
                        <div class="field">
                            <label>Niveau</label>
                            <select class="ui dropdown" name="niveau">
                                <option value="1">Basique</option>
                                <option value="2">Intermédiaire</option>
                                <option value="3">Avancé</option>
                                <option value="4">Bilingue</option>
                                <option value="5">Langue Maternelle</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui container center aligned">
                <i class="icon plus circle big green" onclick="add_lang()" id="langPlus"></i>
            </div>
            <!-- Compétences
            <h3 class="ui dividing green header">Compétences</h3>
            <div style="margin-bottom: 10px;" class="formations-list" id="formationsList">
                <div class="ui segment" id="formationsItem">
                    <div class="two fields">
                        <div class="field">
                            <label>Intitulé du diplôme</label>
                            <input type="text" name="diplomes" placeholder="Intitulé du diplôme">
                        </div>
                        <div class="field">
                            <label>Date d'obtention</label>
                            <input type="date" name="dates" placeholder="26/04/2013">
                        </div>
                    </div>
                    <div class="field">
                        <label>Nom de l'établissement</label>
                        <input type="text" name="nomEtablissements" placeholder="Nom de l'établissement">
                    </div>
                </div>
            </div>
            <div class="ui container center aligned">
                <i class="icon plus circle big green" onclick="add_feed()" id="feedPlus"></i>
            </div> -->
            <!-- Autres -->
            <h3 class="ui dividing green header">Autres informations</h3>
            <div class="ui segment">
                <div class="field">
                    <div class="ui toggle checkbox">
                        <input type="checkbox" name="permisB" class="hidden">
                        <label>Je dispose du permis B</label>
                    </div>
                </div>
                <div class="field">
                    <div class="ui toggle checkbox">
                        <input type="checkbox" name="transport" class="hidden">
                        <label>J'ai un moyen de transport</label>
                    </div>
                </div>
            </div>
            <button type="submit" class="ui fluid large green submit button">Enregistrer</button>
            <div class="ui negative message transition hidden">
                <i class="close icon"></i>
                <div class="header">
                    Erreur !
                </div>
                <p>
                    {% for message in app.flashes('fail') %}
                        {{ message }}
                    {% endfor %}
                </p>
            </div>
        </form>
    </div>
{% endblock %}
{% block javascripts %}
    <script>
        $('#photo-profil').change(function () {
            var i = $(this).prev('label').clone();
            var file = $('#photo-profil')[0].files[0].name;
            $('#pdpLabel').text(file);
        });

        $('#pdpClear').on('click', function () {
            $('#photo-profil').val('');
            $('#pdpLabel').text('Sélectionner');
            $('#pdp').attr('src', '{{ asset('img/placeholders/elyse.png') }}');
        });

        var nbForm = nbExp = nbLang = 1

        function add_feed() {
            if (nbForm < 8) {
                $('#feedPlus').transition('jiggle');
                nbForm += 1;
                let div1 = document.createElement('div');
                div1.classList.add('ui');
                div1.classList.add('segment');
                div1.classList.add('form' + nbForm);
                div1.classList.add('transition');
                div1.classList.add('hidden');
                div1.innerHTML = document.getElementById('formationsItem').innerHTML;
                document.getElementById('formationsList').appendChild(div1);
                $(div1).transition('scale')
            } else {
                $('#feedPlus').transition('shake');
            }
        }

        function add_exp() {
            if (nbExp < 12) {
                $('#expPlus').transition('jiggle');
                nbExp += 1;
                let div1 = document.createElement('div');
                div1.classList.add('ui');
                div1.classList.add('segment');
                div1.classList.add('exp' + nbExp);
                div1.classList.add('transition');
                div1.classList.add('hidden');
                div1.innerHTML = document.getElementById('experiencesItem').innerHTML;
                document.getElementById('experiencesList').appendChild(div1);
                $(div1).transition('scale')
            } else {
                $('#expPlus').transition('shake');
            }
        }

        function add_lang() {
            if (nbLang < 5) {
                $('#langPlus').transition('jiggle');
                nbLang += 1;
                let div1 = document.createElement('div');
                div1.classList.add('ui');
                div1.classList.add('segment');
                div1.classList.add('lang' + nbLang);
                div1.classList.add('transition');
                div1.classList.add('hidden');
                div1.innerHTML = document.getElementById('languesItem').innerHTML;
                document.getElementById('languesList').appendChild(div1);
                $(div1).transition('scale')
            } else {
                $('#langPlus').transition('shake');
            }
        }

        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#pdp')
                        .attr('src', e.target.result)
                };

                reader.readAsDataURL(input.files[0]);
            }
        }
    </script>
{% endblock %}
